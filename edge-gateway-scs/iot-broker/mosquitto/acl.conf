# BEACON IoT Broker - Access Control List
# =======================================

# Gateway permissions - Full access for management
user beacon-gateway
topic readwrite #

# Device topic patterns
# Devices can only access their own topics based on their username
pattern readwrite beacon/%u/device/+/data
pattern readwrite beacon/%u/device/+/status
pattern readwrite beacon/%u/device/+/command
pattern readwrite beacon/%u/device/+/config
pattern read beacon/%u/device/+/response

# Management topics - restricted to gateway
topic deny beacon/admin/#
topic deny beacon/config/#
topic deny beacon/policy/#
topic deny beacon/management/#

# Broadcast topics - read-only for devices
pattern read beacon/broadcast/+
pattern read beacon/announcement/+
pattern read beacon/alerts/+

# Device registration topics
pattern readwrite beacon/%u/registration/+
pattern read beacon/%u/registration/response

# Device discovery and presence
pattern readwrite beacon/%u/presence/+
pattern read beacon/discovery/+

# Sensor data topics by device type
pattern readwrite beacon/%u/sensors/+/data
pattern readwrite beacon/%u/actuators/+/command
pattern read beacon/%u/actuators/+/status

# Edge-specific topics for gateway coordination
pattern readwrite beacon/%u/edge/+
pattern read beacon/edge/broadcast/+

# Diagnostic and monitoring topics
pattern readwrite beacon/%u/diagnostics/+
pattern read beacon/monitoring/+

# Alert and notification topics
pattern readwrite beacon/%u/alerts/+
pattern read beacon/notifications/+

# Data aggregation topics
pattern readwrite beacon/%u/aggregated/+
pattern read beacon/analytics/+

# Special system topics (gateway only)
user beacon-system
topic readwrite $SYS/#
topic readwrite beacon/system/#
topic readwrite beacon/gateway/#

# Admin user for management interface
user beacon-admin
topic readwrite #

# Read-only monitoring user
user beacon-monitor
topic read #
topic deny beacon/admin/#
topic deny beacon/config/#

# Device template for automatic user creation
# %u will be replaced with the device's username
# These patterns ensure devices can only access their own data
